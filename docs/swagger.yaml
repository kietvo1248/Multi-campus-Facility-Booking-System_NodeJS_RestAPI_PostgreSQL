openapi: 3.0.0
info:
  title: FPTU Facility Booking System API
  description: Tài liệu API cho hệ thống đặt phòng FPTU Multi-campus (Clean Architecture).
  version: 1.0.0
servers:
  - url: http://localhost:6969/api
    description: Local Development Server

# --- CẤU HÌNH BẢO MẬT ---
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: "Nhập token JWT vào đây để xác thực các API khóa."

  # --- ĐỊNH NGHĨA DATA MODELS (SCHEMAS) ---
  schemas:
    # 1. Model Input khi đăng nhập
    LoginInput:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
          example: "admin@fpt.edu.vn"
          description: "Email của user"
        password:
          type: string
          format: password
          example: "123456"
          description: "Mật khẩu đăng nhập"

    # 2. Model User (Trả về thông tin an toàn, không có password)
    User:
      type: object
      properties:
        id:
          type: integer
          example: 1
        fullName:
          type: string
          example: "Nguyen Van Admin"
        email:
          type: string
          format: email
          example: "admin@fpt.edu.vn"
        role:
          type: string
          enum: [STUDENT, LECTURER, FACILITY_ADMIN]
          example: "FACILITY_ADMIN"
        phoneNumber:
          type: string
          nullable: true
          example: "0901234567"
        campusId:
          type: integer
          example: 1
        campus:
          type: string
          description: "Tên campus (được include từ bảng Campus)"
          example: "FPTU HCM - Quan 9"
        isActive:
          type: boolean
          example: true

    # 3. Model Response khi Login thành công
    LoginResponse:
      type: object
      properties:
        message:
          type: string
          example: "Đăng nhập thành công"
        token:
          type: string
          description: "JWT Token dùng để xác thực (Access Token)"
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        user:
          $ref: '#/components/schemas/User'

    # 4. Model Lỗi chung
    ErrorResponse:
      type: object
      properties:
        message:
          type: string
          example: "Thông tin đăng nhập không chính xác."

# --- ĐỊNH NGHĨA CÁC API (PATHS) ---
paths:
  # ==================================
  # 1. ĐĂNG NHẬP (Public)
  # ==================================
  /auth/login:
    post:
      summary: Đăng nhập hệ thống (Email/Password)
      description: API xác thực người dùng và trả về JWT Token.
      tags:
        - Authentication
      requestBody:
        description: Thông tin đăng nhập
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginInput'
      responses:
        '200':
          description: Đăng nhập thành công
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '400':
          description: Thiếu email hoặc mật khẩu
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Sai email hoặc mật khẩu / Tài khoản bị khóa
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ==================================
  # 2. XEM PROFILE (Protected)
  # ==================================
  /auth/profile:
    get:
      summary: Xem thông tin cá nhân (My Profile)
      description: >
        Lấy thông tin chi tiết của người dùng đang đăng nhập.
        Yêu cầu header `Authorization: Bearer <token>`.
      tags:
        - Authentication
      security:
        - bearerAuth: [] # Yêu cầu khóa bảo mật JWT
      responses:
        '200':
          description: Lấy thông tin thành công
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '401':
          description: Chưa đăng nhập hoặc Token không hợp lệ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Token hết hạn
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Không tìm thấy user (User trong token không tồn tại)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'